@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
	color-scheme: dark;
	/* Design tokens (initial contrast audit foundation) */
	--wcr-color-bg: #0b0d16;
	--wcr-color-surface: #101425;
	--wcr-text-primary: #f1f5f9; /* slate-100 */
	--wcr-text-secondary: #94a3b8; /* slate-400 */
	--wcr-border-interactive: #94a3b8; /* slate-400 */
	--wcr-border-interactive-contrast: #cbd5e1; /* slate-300 for high contrast */
	--wcr-focus-ring: #ffcc66; /* LCARS amber */
	--wcr-focus-ring-alt: #ffffff; /* used on amber / high contrast surfaces */
}
body { color: #f1f5f9; background: var(--wcr-color-bg); }
body.wcr-contrast-high {
	--wcr-border-interactive: var(--wcr-border-interactive-contrast);
	--wcr-text-secondary: #cbd5e1;
	--wcr-focus-ring: var(--wcr-focus-ring-alt);
}

/* --- Skip Link (a11y) --- */
.skip-link {
	position: absolute;
	top: 0.25rem;
	left: 0.5rem;
	padding: 0.5rem 0.75rem;
	background: #ffcc66;
	color: #000;
	border-radius: 0.5rem;
	font-weight: 600;
	text-decoration: none;
	transform: translateY(-140%);
	transition: transform 0.18s ease, box-shadow 0.18s ease;
	z-index: 1000;
}
.skip-link:focus-visible { transform: translateY(0); box-shadow: 0 0 0 3px #1f2937, 0 0 0 5px #ffcc66; }
.skip-link:focus { outline: none; }

/* --- Global Focus Visibility (a11y) --- */
button:focus-visible,
.lcars-btn:focus-visible,
.lcars-cta:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
	outline: 2px solid var(--wcr-focus-ring);
	outline-offset: 2px;
}
/* Ensure focus ring remains distinct on amber backgrounds */
button.bg-amber-600:focus-visible,
button.bg-amber-500:focus-visible,
.lcars-cta:focus-visible,
button[class*="bg-amber-"]:focus-visible {
	outline-color: var(--wcr-focus-ring-alt);
	box-shadow: 0 0 0 2px rgba(0,0,0,0.55); /* dark halo for contrast */
}

/* Higher contrast fallback for very dark backgrounds */
@media (forced-colors: active) {
	button:focus-visible,
	.lcars-btn:focus-visible,
	.lcars-cta:focus-visible,
	input:focus-visible,
	select:focus-visible,
	textarea:focus-visible { outline: 2px solid CanvasText; }
}

/* --- LCARS helpers --- */
.lcars-card { border-radius:1rem; padding:0; border:1px solid var(--wcr-border-interactive); overflow:hidden; position:relative; background:var(--wcr-color-surface); }
.lcars-rail { position:absolute; left:0; top:0; bottom:0; width:10px; background:#ff9966; }
.lcars-rail-alt { background:#66ccff; }
.lcars-rail-accent { background:#ff6699; }
.lcars-body { padding-left:1rem; padding-right:1rem; padding-top:1rem; padding-bottom:1rem; margin-left:10px; }
@media (min-width:768px){ .lcars-body { padding-left:1.5rem; } }
.lcars-label { display:block; font-size:0.75rem; line-height:1rem; text-transform:uppercase; letter-spacing:0.2em; margin-bottom:0.25rem; color: var(--wcr-text-secondary); }
.lcars-small { font-size:0.75rem; line-height:1rem; color: var(--wcr-text-secondary); }
.lcars-input { border-radius:0.375rem; padding:0.5rem 0.75rem; font-size:0.875rem; line-height:1.25rem; background:#0f1626; border:1px solid var(--wcr-border-interactive); color: var(--wcr-text-primary); }
.lcars-btn { padding:0.25rem 0.5rem; border-radius:0.375rem; font-size:0.875rem; line-height:1.25rem; background:#1e293b; border:1px solid var(--wcr-border-interactive); }
.lcars-btn-locked { background:#d97706; }
.lcars-btn-locked:hover { background:#f59e0b; }
.lcars-cta { font-weight:600; padding:0.5rem 0.75rem; border-radius:0.75rem; color:#000; background:#ffcc66; }

/* --- LCARS control accents (checkboxes, toggles, sliders) --- */
/* Use accessible, bright LCARS palette instead of red */
input[type="checkbox"] {
	accent-color: #ffcc66; /* LCARS amber */
}
input[type="checkbox"]:disabled { accent-color: #a3a3a3; }

/* Range slider (WebKit) */
input[type="range"] {
	appearance: none;
	-webkit-appearance: none;
	width: 100%;
	height: 0.375rem; /* 6px track */
	background: linear-gradient(90deg, #2b314a, #2b314a);
	border-radius: 9999px;
}
input[type="range"]::-webkit-slider-runnable-track {
	height: 0.375rem;
	background: linear-gradient(90deg, #2b314a, #2b314a);
	border-radius: 9999px;
}
input[type="range"]::-webkit-slider-thumb {
	appearance: none;
	-webkit-appearance: none;
	width: 1rem; height: 1rem;
	background: #66ccff; /* LCARS blue accent */
	border: 2px solid #0b0d16;
	border-radius: 9999px;
	margin-top: -0.3125rem; /* center on 6px track */
	box-shadow: 0 0 0 1px #1f2937; /* subtle outline */
}

/* Range slider (Firefox) */
input[type="range"]::-moz-range-track {
	height: 0.375rem;
	background: #2b314a;
	border-radius: 9999px;
}
input[type="range"]::-moz-range-thumb {
	width: 1rem; height: 1rem;
	background: #66ccff;
	border: 2px solid #0b0d16;
	border-radius: 9999px;
	box-shadow: 0 0 0 1px #1f2937;
}

/* High-contrast hover/active states for better visibility */
input[type="range"]:hover::-webkit-slider-thumb { background: #ff9966; }
input[type="range"]:active::-webkit-slider-thumb { background: #ff6699; }
input[type="range"]:hover::-moz-range-thumb { background: #ff9966; }
input[type="range"]:active::-moz-range-thumb { background: #ff6699; }

/* --- Preview Zoom (restored) --- */
.report-zoom { /* text content scales via transform; charts counter-scale */
	--zoom: 1;
	transform-origin: top left;
	transform: scale(var(--zoom));
	width: calc(100% / var(--zoom));
}

/* Inverse scale wrapper for charts to keep visual size stable */
/* Chart wrapper: inverse scale so charts (and their figure container) do NOT zoom */
.chart-no-zoom {
	transform-origin: top left;
	transform: scale(calc(1 / var(--zoom)));
	width: calc(100% * var(--zoom));
	display: block;
	max-width: none;
	overflow: visible;
}

/* Keep zoom / chart size / density controls stable */
/* Controls fixed-size: remove inverse scaling so they do not shrink */
.controls-no-zoom {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 0.5rem;
}

@media (prefers-reduced-motion: reduce) { .report-zoom { transition: none; } }

/* Broader reduced motion support: neutralize common utility transitions & custom animations */
@media (prefers-reduced-motion: reduce) {
	.transition, .transition-all, .transition-colors, .duration-200, .duration-300, .duration-500, .animate-fadeIn, .animate-pulse-border {
		transition: none !important;
		animation: none !important;
	}
	/* Drawer & overlay transforms become instant */
	.translate-y-full, .translate-y-0 { transition: none !important; }
	/* Skip link keeps visibility but no motion */
	.skip-link { transition: none !important; }
}

@media print {
	.report-zoom { transform: none !important; width: 100% !important; }
	.chart-no-zoom { transform: none !important; width: 100% !important; }
}

/* --- Compact Density (restored) --- */
.density-compact .lcars-btn { padding: 0.25rem 0.5rem; font-size: 0.75rem; }
.density-compact .lcars-input { padding: 0.375rem 0.5rem; font-size: 0.8125rem; }
.density-compact .lcars-body { padding-top: 0.5rem; padding-bottom: 0.5rem; padding-left: 1rem; padding-right: 1rem; }
.density-compact #button-bar button { padding: 0.375rem 0.625rem; }
.density-compact #button-bar { padding: 0.5rem 0.75rem; gap: 0.5rem; }
.density-compact input[type="range"] { height: 0.25rem; }
.density-compact input[type="range"]::-webkit-slider-runnable-track { height: 0.25rem; }
.density-compact input[type="range"]::-webkit-slider-thumb { width: 0.75rem; height: 0.75rem; margin-top: -0.25rem; }
.density-compact input[type="range"]::-moz-range-track { height: 0.25rem; }
.density-compact input[type="range"]::-moz-range-thumb { width: 0.75rem; height: 0.75rem; }
.density-compact #printable-report .text-xl { font-size: 1.1rem; }
.density-compact #printable-report .text-lg { font-size: 0.95rem; }
.density-compact #printable-report .text-base { font-size: 0.9rem; }
.density-compact #printable-report .text-sm { font-size: 0.8125rem; }
.density-compact #printable-report .leading-relaxed { line-height: 1.4; }

/* Compact tweaks for Crew Manifest panel */
.density-compact .crew-toolbar .lcars-btn { padding: 0.25rem 0.5rem; font-size: 0.75rem; }
.density-compact .crew-toolbar input[type="number"],
.density-compact .crew-toolbar input[type="text"] { padding: 0.25rem 0.5rem; font-size: 0.8125rem; }
.density-compact .crew-role-btn { font-size: 0.75rem; padding: 0.25rem 0.375rem; }

/* Improve touch DnD behavior on mobile lists */
.overscroll-contain { overscroll-behavior: contain; }
.touch-none { touch-action: none; }

/* --- Contrast Adjustments (WCAG 2.1 AA Non-Text Contrast) --- */
/* Rationale: Original subtle borders (e.g., slate-700 on slate-800 backgrounds, pink-400 at 20% opacity on 5% fill) fell below the 3:1 requirement for component boundaries.
	 Strategy: Elevate border lightness for interactive surfaces & list rows without dramatically altering brand palette. */
/* Elevate generic interactive borders */
button.border-slate-700, button.border-slate-600,
button.border-slate-700:hover, button.border-slate-600:hover,
input.border-slate-700, input.border-slate-600,
select.border-slate-700, select.border-slate-600,
.lcars-btn.border-slate-700, .lcars-btn.border-slate-600,
.lcars-input.border-slate-700, .lcars-input.border-slate-600 {
	border-color: #94a3b8 !important; /* Tailwind slate-400 */
}
/* Zoom / small control buttons inherit stronger border */
#button-bar button.border-slate-600, #button-bar button.border-slate-700 { border-color:#94a3b8 !important; }
/* Strengthen generic slate outline variants when semi-transparent disabled states are used */
button[aria-disabled="true"] { border-color:#64748b !important; }
/* High contrast user preference (where supported) â€“ push borders one step brighter */
@media (prefers-contrast: more) {
	button.border-slate-700, button.border-slate-600,
	input.border-slate-700, input.border-slate-600,
	select.border-slate-700, select.border-slate-600 { border-color:#cbd5e1 !important; /* slate-300 */ }
}

